# juicefs
- 当你有一些需要持久化存储的内容，然后对于目前服务来说，只有这个存储层而影响服务的多实例部署，则可以选择把这个存储层（文件）写入juicefs

## 场景
* 特别重要的日志服务，仅仅记录日志文件，但是需要多实例都能访问
* 同步远程的数据到本地，同时本地服务还需要提供无状态的服务给外部访问

## 实际使用
* 存储超过300G以上的文件信息，有一些大文件，超过2G

## Cache策略
* `--cache-size` 与 `--free-space-ratio`

缓存空间大小（单位 MiB，默认 102400）与缓存盘的最少剩余空间占比（默认 0.1）。这两个参数任意一个达到阈值，均会自动触发缓存淘汰，使用的是类似于 LRU 的策略，即尽量清理较早且较少使用的缓存。

* 另外，可以在挂载文件系统时通过 --cache-dir 选项设置在当前系统可以访问的任何存储路径上。对于没有访问 /var 目录权限的普通用户，可以把缓存设置在用户的 HOME 目录中，例如：
```bash
juicefs mount --cache-dir ~/jfscache redis://127.0.0.1:6379/1 /mnt/myjfs
```

> 提示:
> 
> 建议缓存目录尽量使用独立的高性能盘，不要用系统盘，也不要和其它应用共用。共用不仅会相互影响性能，还可能导致其它应用出错（例如磁盘剩余空间不足）。如果无> 法避免必须共用那一定要预估好其它应用所需的磁盘容量，限制缓存空间大小（--cache-size），避免 JuiceFS 的读缓存或者写缓存占用过多空间。


## 实际效果
* 生产环境出现cache目录超过100G的情况，但是经过一天或者一段时间之后，cache从123G也会下降到103G，所以默认设置的策略就可以满足Cache配置
* 如果需要手动调整，只需重新mount，并且设置Cache-size就可以，Cache-size的大小使用单位为MiB